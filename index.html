<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Awesome Website Quiz! üöÄ</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles based on the provided design image */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #9333ea; /* Purple background color */
            background-image: url('data:image/svg+xml;utf8,<svg width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="pattern-07e53f" patternUnits="userSpaceOnUse" width="100" height="100" patternTransform="scale(1) rotate(0)"><path d="M 0 0 L 0 50 L 50 100 L 100 50 L 50 0 L 0 50" stroke="%23a855f7" stroke-width="1.5" fill="none"/></pattern></defs><rect width="100%" height="100%" fill="url(%23pattern-07e53f)" opacity="0.3"/></svg>');
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            max-width: 600px;
        }
        .card {
            background-color: #ffffff;
            border-radius: 1.5rem; /* rounded-3xl */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
        }
        .option-label {
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            border: 2px solid #3b82f6; /* Blue border for all options */
            color: #1f2937;
            background-color: #eff6ff; /* Light blue background */
        }
        .option-label:hover {
            background-color: #dbeafe; /* Lighter blue on hover */
        }
        .option-label.majority {
            border-width: 4px; /* Thicker border for majority */
            border-color: #3b82f6;
            background-color: #dbeafe; /* Slightly darker light blue */
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3), 0 2px 4px -2px rgba(59, 130, 246, 0.2);
        }
        .option-label.correct {
            border-color: #10b981; /* Green border for correct */
            background-color: #d1fae5; /* Light green background */
        }
        .option-label.incorrect {
            border-color: #ef4444; /* Red border for incorrect */
            background-color: #fee2e2; /* Light red background */
        }
        input[type="radio"] {
            display: none; /* Hide default radio button */
        }
        /* Custom button styling */
        #lock-in-btn {
            background-color: #10b981; /* Primary Green */
            text-shadow: 0 1px 1px rgba(0,0,0,0.2);
            box-shadow: 0 4px 0 0 #059669; /* Darker green shadow */
            transition: all 0.1s ease-in-out;
        }
        #lock-in-btn:hover {
            background-color: #059669;
        }
        #lock-in-btn:active {
            box-shadow: 0 1px 0 0 #059669;
            transform: translateY(3px);
        }
        .red-button {
            background-color: #ef4444;
            box-shadow: 0 4px 0 0 #dc2626;
        }
        .red-button:hover {
            background-color: #dc2626;
        }
        .red-button:active {
            box-shadow: 0 1px 0 0 #dc2626;
            transform: translateY(3px);
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-green': '#10b981',
                        'secondary-blue': '#3b82f6',
                        'quiz-purple': '#9333ea',
                    }
                }
            }
        }
    </script>
</head>
<body class="p-4 sm:p-8">

    <div class="container mx-auto">
        <div id="quiz-container" class="card p-6 sm:p-8">
            <!-- Dynamic quiz content will be rendered here -->
        </div>
        
        <div class="text-center mt-6">
            <button onclick="window.resetAllData()" class="red-button px-4 py-2 text-white font-bold text-sm rounded-lg shadow-lg transition duration-200">
                Reset All Votes & Progress
            </button>
            <p class="text-xs text-white opacity-80 mt-1">Clears all stored data to restart with 0 votes.</p>
        </div>
    </div>

    <script>
        // --- CONSTANTS ---
        const USER_ID = 'my-current-user'; // Unique ID for current user's vote
        const SIMULATED_USERS = ['sim1', 'sim2', 'sim3', 'sim4', 'sim5', 'sim6', 'sim7', 'sim8'];
        const TOTAL_VOTERS = 1 + SIMULATED_USERS.length; // 9 total votes (1 real + 8 simulated)
        
        // --- QUIZ DATA ---
        const tests = [
            {
                id: 'test1',
                title: 'Passage 1: The Browser and the Homepage',
                icon: 'üíª Awesome Website Quiz! üöÄ',
                text: 
                    "Every day, Maria wants to watch a video. First, she opens her **browser** program. This is the application she uses for the internet. She looks at the top of the screen where the **Address Bar** is. In this space, she must type the full **URL** of the website. For example, she types 'www.videozone.com'. After she presses 'Enter,' the website starts to load. The first screen she sees is the **Homepage**. This is the main page where she can start her search. Maria always starts here because it is fast. When the whole website loads, she is ready to begin.",
                questions: [
                    { q: "What is the name of the program Maria opens first?", options: ["The Link", "Her browser", "The Address Bar", "The Homepage"], correct: 1 },
                    { q: "What is the 'main door' of the website?", options: ["The URL", "The Address Bar", "The Homepage", "The Browser"], correct: 2 },
                    { q: "Where does Maria type the website's address?", options: ["The screen", "The Link", "The Browser", "The Address Bar"], correct: 3 },
                    { q: "What does Maria do after she types the address?", options: ["She scrolls.", "She presses 'Enter.'", "She clicks the icon.", "She starts the video."], correct: 1 },
                    { q: "What is the website's full address called?", options: ["The Homepage", "The Application", "The URL", "The Program"], correct: 2 },
                ]
            },
            {
                id: 'test2',
                title: 'Passage 2: Controls and Actions',
                icon: 'üñ±Ô∏è Controls and Actions üëÜ',
                text: 
                    "To interact with the page, you **click** your mouse or **tap** your screen to select things or buttons. If you want to put information into a search box, you **type** your words. When you want to move the page up or down to see more content, you **scroll**. When you select a button or an **icon** (a small picture that links to something), the page may need time to **load**. Sometimes, the connection is slow, and the page loads slowly.",
                questions: [
                    { q: "What is the action when you use your finger on a screen?", options: ["To scroll", "To click", "To load", "To tap"], correct: 3 },
                    { q: "You write words in a text box. This action is...", options: ["To type", "To load", "To scroll", "To click"], correct: 0 },
                    { q: "What is an ICON?", options: ["The place where you write.", "A small picture that links to something.", "A slow connection.", "The main page of a site."], correct: 1 },
                    { q: "The website loads. What does 'to load' mean in this context?", options: ["To scroll up.", "To open the browser.", "To need time to prepare content.", "To click the button."], correct: 2 },
                    { q: "If you want to move the page down, you need to...", options: ["load.", "type.", "scroll.", "tap."], correct: 2 },
                ]
            }
            // You can add more tests here, pulling data from the uploaded PPT files if needed
        ];


        // --- STATE AND LOCAL STORAGE MANAGEMENT ---
        let state = {
            currentTestIndex: 0,
            currentQuestionIndex: 0,
            isReadingPhase: true,
            // Stores all votes: { 'test1-q0': { 'my-current-user': 1, 'sim1': 2, ... } }
            allVotes: {}, 
            // Stores whether a question has been checked (locally)
            questionStatus: tests.reduce((acc, test) => { acc[test.id] = {}; return acc; }, {}),
            // Flag to ensure simulation runs only once
            simulationInitialized: false
        };
        
        const quizContainer = document.getElementById('quiz-container');

        // Load votes and simulation data from local storage
        function loadData() {
            const storedVotes = localStorage.getItem('quizAllVotes');
            if (storedVotes) {
                state.allVotes = JSON.parse(storedVotes);
            }

            const storedState = localStorage.getItem('quizState');
            if (storedState) {
                const loadedState = JSON.parse(storedState);
                state.currentTestIndex = loadedState.currentTestIndex || 0;
                state.currentQuestionIndex = loadedState.currentQuestionIndex || 0;
                state.isReadingPhase = loadedState.isReadingPhase !== undefined ? loadedState.isReadingPhase : true;
                state.questionStatus = loadedState.questionStatus || state.questionStatus;
                state.simulationInitialized = loadedState.simulationInitialized !== undefined ? loadedState.simulationInitialized : false;
            }
        }

        // Save current votes and state to local storage
        function saveData() {
            localStorage.setItem('quizAllVotes', JSON.stringify(state.allVotes));
            localStorage.setItem('quizState', JSON.stringify({
                currentTestIndex: state.currentTestIndex,
                currentQuestionIndex: state.currentQuestionIndex,
                isReadingPhase: state.isReadingPhase,
                questionStatus: state.questionStatus,
                simulationInitialized: state.simulationInitialized
            }));
        }

        // Initialize random, persistent votes for the simulated users
        function initializeSimulatedVotes() {
             if (state.simulationInitialized) return; // Don't run twice
            
            tests.forEach(test => {
                test.questions.forEach((qData, qIndex) => {
                    const key = `${test.id}-q${qIndex}`;
                    
                    if (!state.allVotes[key]) {
                        state.allVotes[key] = {}; 
                    }
                    
                    // Initialize current user's vote if not present
                    if (state.allVotes[key][USER_ID] === undefined) {
                        state.allVotes[key][USER_ID] = null; 
                    }

                    SIMULATED_USERS.forEach(simId => {
                        // Assign a random vote index (0, 1, 2, 3)
                        if (state.allVotes[key][simId] === undefined) {
                            state.allVotes[key][simId] = Math.floor(Math.random() * qData.options.length);
                        }
                    });
                });
            });
            state.simulationInitialized = true;
            saveData();
        }


        // --- CORE QUIZ LOGIC ---

        // Initial setup function
        function initQuiz() {
            loadData();
            renderCurrentTest();
        }
        
        // Function to clear all local storage data and restart the quiz
        function resetAllData() {
            localStorage.clear();
            window.location.reload(); 
        }

        // Renders the main structure for the current test (Reading Text + Question Area)
        function renderCurrentTest() {
            const currentTest = tests[state.currentTestIndex];
            
            if (state.isReadingPhase) {
                 state.currentQuestionIndex = 0;
            }

            // Set up the reading text section
            const readingSection = `
                <div id="reading-section" class="bg-gray-50 p-6 rounded-lg text-gray-700 border-l-4 border-quiz-purple/50 ${state.isReadingPhase ? '' : 'hidden'}">
                    <p class="whitespace-pre-wrap text-base">${currentTest.text}</p>
                    <p class="text-sm text-gray-500 mt-4 text-center">This section has questions 1 to ${currentTest.questions.length}.</p>
                    
                    <button onclick="startQuestions()" id="start-btn" class="mt-6 w-full red-button px-6 py-4 text-white font-bold rounded-xl shadow-lg transition duration-200 text-xl">
                        Start Questions for ${currentTest.title}
                    </button>
                </div>
            `;
            
            // Set up the main quiz container
            quizContainer.innerHTML = `
                <header class="text-center mb-6">
                    <h1 class="text-2xl font-extrabold text-quiz-purple">${currentTest.icon}</h1>
                    <h2 class="text-xl font-bold text-gray-700 mt-1">${currentTest.title}</h2>
                </header>

                <div id="quiz-body">
                    ${readingSection}

                    <!-- Question Section -->
                    <div id="question-section" class="${state.isReadingPhase ? 'hidden' : ''}">
                        <div id="question-content">
                            <!-- Question and options will be injected here -->
                        </div>
                        <div id="navigation-controls" class="mt-8 flex justify-between space-x-4">
                            <!-- Navigation buttons injected here -->
                        </div>
                    </div>
                </div>

                <!-- Message Box for Feedback -->
                <div id="feedback-box" class="mt-6 p-4 rounded-lg bg-yellow-100 border border-yellow-400 text-sm text-yellow-800 hidden">
                    <!-- Feedback injected here -->
                </div>
            `;
            
            if (!state.isReadingPhase) {
                displayCurrentQuestion();
            }

            saveData();
        }

        // Hides reading text and shows the current question
        function startQuestions() {
            document.getElementById('reading-section').classList.add('hidden');
            document.getElementById('question-section').classList.remove('hidden');
            state.isReadingPhase = false;
            displayCurrentQuestion();
        }
        
        // Updates the current user's vote and re-renders
        function updateVote(qIndex, selectedValue) {
            const currentTest = tests[state.currentTestIndex];
            const key = `${currentTest.id}-q${qIndex}`;
            
            // CRITICAL CHANGE: Initialize simulated votes ONLY after the first user interaction
            if (!state.simulationInitialized) {
                initializeSimulatedVotes();
            }

            // Ensure question key exists
            if (!state.allVotes[key]) {
                state.allVotes[key] = {};
            }
            
            // Record the current user's vote
            state.allVotes[key][USER_ID] = selectedValue;
            saveData();
            
            // Re-render to show the updated vote counts and majority
            displayCurrentQuestion();
        }

        // Renders the current question based on state.currentQuestionIndex
        function displayCurrentQuestion() {
            const currentTest = tests[state.currentTestIndex];
            const qData = currentTest.questions[state.currentQuestionIndex];
            const qIndex = state.currentQuestionIndex;
            const testId = currentTest.id;
            const totalQuestions = currentTest.questions.length;
            const key = `${testId}-q${qIndex}`;
            
            const questionContent = document.getElementById('question-content');
            const navigationControls = document.getElementById('navigation-controls');
            const feedbackBox = document.getElementById('feedback-box');

            // Get votes, initialize if necessary (for 0-start display)
            const currentQuestionVotes = state.allVotes[key] || {};
            if (!currentQuestionVotes[USER_ID]) {
                currentQuestionVotes[USER_ID] = null; // Ensure user vote starts as null
            }
            
            // --- TALLY VOTES AND FIND MAJORITY ---
            const voteCounts = qData.options.map(() => 0);
            let maxVotes = -1;
            let majorityAnswerIndex = -1;
            let totalVotesCast = 0;
            
            // Only count simulated votes if the simulation has been initialized
            const votesToTally = state.simulationInitialized ? currentQuestionVotes : {};
            
            Object.keys(votesToTally).forEach(voterId => {
                const optionIndex = votesToTally[voterId];
                if (optionIndex !== undefined && optionIndex !== null) {
                    voteCounts[optionIndex]++;
                    totalVotesCast++;
                    if (voteCounts[optionIndex] > maxVotes) {
                        maxVotes = voteCounts[optionIndex];
                        majorityAnswerIndex = optionIndex;
                    } 
                }
            });

            const myVote = currentQuestionVotes[USER_ID];
            const isChecked = state.questionStatus[testId] && state.questionStatus[testId][qIndex] !== undefined;
            const isCorrect = isChecked ? state.questionStatus[testId][qIndex] : undefined;

            // 1. Render Question Content
            questionContent.innerHTML = `
                <p class="text-center text-gray-500 mb-4 font-semibold">Question ${qIndex + 1} of ${totalQuestions}</p>
                <div class="question p-4 rounded-lg">
                    <p class="font-bold text-xl text-gray-800 mb-4">
                        ${qIndex + 1}. ${qData.q}
                    </p>
                    <div class="options space-y-3">
                        ${qData.options.map((option, oIndex) => {
                            const inputName = `${testId}-q${qIndex}`;
                            const isVotedByMe = myVote === oIndex;
                            const isMajorityAnswer = oIndex === majorityAnswerIndex && maxVotes > 0;
                            const currentVoteCount = voteCounts[oIndex] || 0;

                            let labelClass = 'flex items-center justify-between p-4 rounded-xl option-label';

                            // Highlight my selection
                            if (isVotedByMe) {
                                labelClass += ' bg-blue-200 border-secondary-blue';
                            }
                            
                            // Highlight group majority choice (blue border)
                            if (isMajorityAnswer && !isChecked) {
                                labelClass += ' majority';
                            }
                            
                            // Fixed answer feedback
                            if (isChecked) {
                                // Highlight the FIXED correct answer with green
                                if (oIndex === qData.correct) {
                                    labelClass += ' correct';
                                }
                                // Highlight my INCORRECT vote with red
                                else if (isVotedByMe && oIndex !== qData.correct) {
                                     labelClass += ' incorrect';
                                }
                                // Disable interactions after checking
                                labelClass += ' cursor-default';
                            }

                            return `
                                <label class="${labelClass}" for="${inputName}-o${oIndex}">
                                    <span class="text-base">${option}</span>
                                    <span class="font-semibold text-sm text-gray-500">
                                        (${currentVoteCount} votes)
                                    </span>
                                    <input 
                                        type="radio" 
                                        id="${inputName}-o${oIndex}" 
                                        name="${inputName}" 
                                        value="${oIndex}" 
                                        ${isVotedByMe ? 'checked' : ''} 
                                        ${isChecked ? 'disabled' : ''}
                                        onchange="window.updateVote(${qIndex}, ${oIndex})"
                                    >
                                </label>
                            `;
                        }).join('')}
                    </div>
                </div>
                
                <p class="mt-4 text-center text-sm text-gray-500">
                    Total Voters (Simulated + Me): ${TOTAL_VOTERS}.
                    ${state.simulationInitialized ? `Group Answer (Majority Vote): Option ${majorityAnswerIndex !== -1 ? majorityAnswerIndex + 1 : 'N/A'}` : 'Group voting is disabled until you make your first selection.'}
                </p>
            `;

            // 2. Render Navigation Controls
            const prevButton = `<button onclick="navigateQuestion(-1)" ${qIndex === 0 ? 'disabled' : ''} class="px-4 py-2 bg-gray-200 text-gray-700 font-bold rounded-lg transition duration-200 disabled:opacity-50">‚Üê Previous</button>`;
            
            let nextButton;
            let checkButton;

            if (!isChecked) {
                // LOCK IN / CHECK BUTTON
                checkButton = `<button id="lock-in-btn" onclick="checkAnswer()" class="w-full sm:w-auto px-8 py-3 text-white font-bold rounded-xl shadow-lg transition duration-200 text-lg">
                                LOCK IN GROUP VOTE!
                              </button>`;
            } else {
                 // NEXT BUTTON
                if (qIndex < totalQuestions - 1) {
                    checkButton = `<button onclick="navigateQuestion(1)" class="w-full sm:w-auto px-8 py-3 bg-secondary-blue hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg transition duration-200 text-lg">
                                    Next Question ‚Üí
                                  </button>`;
                } else {
                    checkButton = `<button onclick="showFinalResults()" class="w-full sm:w-auto px-8 py-3 bg-primary-green hover:bg-green-700 text-white font-bold rounded-xl shadow-lg transition duration-200 text-lg">
                                    Finish Test and Score!
                                  </button>`;
                }
            }


            navigationControls.innerHTML = `
                <div class="flex-shrink-0">${prevButton}</div>
                <div class="flex-grow">${checkButton}</div>
                <div class="flex-shrink-0">
                    <button onclick="navigateQuestion(1)" ${qIndex >= totalQuestions - 1 || !isChecked ? 'disabled' : ''} class="px-4 py-2 bg-gray-200 text-gray-700 font-bold rounded-lg transition duration-200 disabled:opacity-50">Next ‚Üí</button>
                </div>
            `;
            
            // 3. Render Feedback
            if (isChecked !== undefined) {
                feedbackBox.classList.remove('hidden', 'bg-yellow-100', 'border-yellow-400', 'text-yellow-800', 'bg-red-100', 'border-red-400', 'text-red-800');
                
                if (isCorrect) {
                    feedbackBox.classList.add('bg-green-100', 'border-green-400', 'text-green-800');
                    feedbackBox.innerHTML = '<p class="font-bold">‚úÖ Correct!</p> <p>Your individual choice matched the fixed answer key. Great job!</p>';
                } else {
                    feedbackBox.classList.add('bg-red-100', 'border-red-400', 'text-red-800');
                    feedbackBox.innerHTML = '<p class="font-bold">‚ùå Incorrect.</p> <p>Your individual choice did not match the fixed answer key. The correct option is highlighted in green.</p>';
                }
            } else {
                feedbackBox.classList.add('hidden');
            }


            // Scroll to the question content only on initial load
            questionContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Handles checking the answer for the current question
        function checkAnswer() {
            const currentTest = tests[state.currentTestIndex];
            const qData = currentTest.questions[state.currentQuestionIndex];
            const qIndex = state.currentQuestionIndex;
            const testId = currentTest.id;

            const myVote = state.allVotes[`${testId}-q${qIndex}`] ? state.allVotes[`${testId}-q${qIndex}`][USER_ID] : null;

            const feedbackBox = document.getElementById('feedback-box');
            if (myVote === undefined || myVote === null) {
                feedbackBox.classList.remove('hidden');
                feedbackBox.classList.add('bg-yellow-100', 'border-yellow-400', 'text-yellow-800');
                feedbackBox.innerHTML = '<p class="font-bold">Wait!</p> <p>Please click on one of the options (vote) before locking in your answer.</p>';
                feedbackBox.scrollIntoView({ behavior: 'smooth', block: 'start' });
                return;
            }
            
            // Check against the fixed correct answer
            const isCorrect = myVote === qData.correct;
            
            // If the user has not voted or checked, run the check
            if (state.questionStatus[testId][qIndex] === undefined) {
                state.questionStatus[testId][qIndex] = isCorrect;
                saveData();
            }
            
            // Re-render the current question to show fixed-key feedback and enable next button
            displayCurrentQuestion();
        }

        // Handles moving between questions
        function navigateQuestion(direction) {
            const currentTest = tests[state.currentTestIndex];
            const newIndex = state.currentQuestionIndex + direction;

            if (newIndex >= 0 && newIndex < currentTest.questions.length) {
                state.currentQuestionIndex = newIndex;
                displayCurrentQuestion();
            } else if (newIndex === currentTest.questions.length && direction === 1) {
                showFinalResults();
            }
            saveData();
        }

        // Calculates and displays the final score for the current test
        function showFinalResults() {
            const currentTest = tests[state.currentTestIndex];
            const testId = currentTest.id;
            let score = 0;
            const totalQuestions = currentTest.questions.length;
            
            // Recalculate score based on current user's vote against the fixed answer
            for (let i = 0; i < totalQuestions; i++) {
                const key = `${testId}-q${i}`;
                const userVote = state.allVotes[key] ? state.allVotes[key][USER_ID] : undefined;
                
                // Ensure a vote exists before checking correctness
                if (userVote !== undefined && userVote !== null) {
                    const isCorrect = userVote === currentTest.questions[i].correct;
                    if (isCorrect) {
                        score++;
                    }
                    state.questionStatus[testId][i] = isCorrect;
                }
            }
            saveData();

            // Display overall results
            const color = score >= totalQuestions * 0.7 ? 'text-primary-green' : 'text-red-500';
            const message = score >= totalQuestions * 0.7 ? "Excellent work! You've shown a strong grasp of the technical vocabulary." : "Good effort! Let's review the topics to improve your understanding of the core concepts.";
            
            quizContainer.innerHTML = `
                <div class="text-center p-6 sm:p-10">
                    <h2 class="text-4xl font-extrabold text-quiz-purple mb-4">Test Complete! üéâ</h2>
                    <p class="text-xl font-bold text-gray-800">Final Score for ${currentTest.title}:</p>
                    <p class="text-6xl font-black mt-4 ${color}">${score} / ${totalQuestions}</p>
                    <p class="text-md text-gray-700 mt-4 max-w-md mx-auto">${message}</p>
                    
                    <div class="mt-8 flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4 justify-center">
                        <button onclick="navigateTest(1)" class="px-6 py-3 bg-secondary-blue hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg transition duration-200">
                            ${state.currentTestIndex < tests.length - 1 ? 'Go to Next Test' : 'Quiz Complete!'}
                        </button>
                        <button onclick="navigateTest(0)" class="px-6 py-3 bg-gray-400 hover:bg-gray-500 text-white font-bold rounded-xl shadow-lg transition duration-200">
                            Review Test 
                        </button>
                    </div>
                </div>
            `;
            quizContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        // Handles navigation between different tests
        function navigateTest(direction) {
            const newIndex = state.currentTestIndex + direction;
            if (newIndex >= 0 && newIndex < tests.length) {
                state.currentTestIndex = newIndex;
                state.isReadingPhase = true;
                renderCurrentTest();
            } else if (newIndex === tests.length) {
                 quizContainer.innerHTML = `
                    <div class="text-center p-6 sm:p-10">
                        <h2 class="text-4xl font-extrabold text-primary-green mb-4">All Quizzes Finished!</h2>
                        <p class="text-xl text-gray-700">You have completed all the Technical English quizzes available.</p>
                        <button onclick="navigateTest(0)" class="mt-6 px-6 py-3 bg-secondary-blue hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg transition duration-200">
                            Start Reviewing
                        </button>
                    </div>
                `;
            }
            saveData();
        }
        
        // Expose functions globally for HTML calls
        window.updateVote = updateVote;
        window.startQuestions = startQuestions;
        window.checkAnswer = checkAnswer;
        window.navigateQuestion = navigateQuestion;
        window.showFinalResults = showFinalResults;
        window.renderCurrentTest = renderCurrentTest;
        window.navigateTest = navigateTest;
        window.resetAllData = resetAllData; 

        // Initialize the app on load
        initQuiz();
    </script>
</body>
</html>
